<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Companies</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<nav class="nav">
  <a href="index.html" class="nav-home" aria-label="Home">⌂</a>
  <button id="navMenuBtn" class="nav-menu-btn" type="button" aria-expanded="false" aria-controls="navMenu" aria-label="Open navigation">☰</button>
  <div id="navMenu" class="nav-menu" hidden>
    <a href="index.html">Home</a>
    <a href="enter-shift.html">Enter Shift</a>
    <a href="summary.html">Summary</a>
    <a href="shifts.html">All Shifts</a>
    <a href="companies.html">Companies</a>
    <a href="vehicles.html">Vehicles</a>
    <a href="settings.html">Settings</a>
    <a href="user-guide.html">User Guide</a>
  </div>
</nav>

<div class="container">
  <div class="screen">
    <h1>Companies</h1>

    <!-- Toggle button -->
    <button class="button-secondary" type="button" id="toggleCompanyFormBtn">
      Add / Edit Company
    </button>

    <!-- Form wrapper (collapsed by default) -->
    <div id="companyFormWrap" style="display:none; margin-top:14px;">

      <input type="hidden" id="companyId">

      <label>Company Name</label>
      <input type="text" id="companyName" placeholder="e.g. Acme Logistics">

      <label>Base Hourly Rate (£)</label>
      <input type="number" step="0.01" id="companyBaseRate" placeholder="e.g. 17.75">

      <label>Pay Mode</label>
      <select id="payMode">
        <option value="weekly">Weekly overtime (after base weekly hours)</option>
        <option value="daily">Daily overtime (after X hours worked)</option>
      </select>

      <!-- Only relevant for daily mode -->
      <div id="dailyOtFields" style="display:none;">
        <label>Daily OT after worked hours</label>
        <input type="number" step="0.25" id="dailyOTAfterWorkedHours" placeholder="e.g. 10">
        <div class="small" style="margin-top:6px;">
          Example: 10 means any time worked beyond 10.00 hrs is overtime (break doesn’t count).
        </div>
      </div>

      <label>Minimum paid shift hours (optional)</label>
      <input type="number" step="0.25" id="minPaidShiftHours" placeholder="e.g. 8">

      <h2>Bonus</h2>

      <label>Bonus Type</label>
      <select id="bonusType">
        <option value="none">None</option>
        <option value="night_window">Night-window bonus</option>
        <option value="per_shift_flat">Flat per shift bonus</option>
      </select>

      <div id="bonusModeWrap">
        <label>Bonus Mode</label>
        <select id="bonusMode">
          <option value="per_hour">Per hour (within window)</option>
          <option value="per_shift">Per shift (if any time in window)</option>
          <option value="per_week">Per week (once per week if any time in window)</option>
        </select>
      </div>

      <label>Bonus Amount (£)</label>
      <input type="number" step="0.01" id="bonusAmount" placeholder="0.50">

      <div id="bonusWindow" class="grid">
        <div>
          <label>Window Start</label>
          <input type="time" id="bonusStart" value="22:00">
        </div>
        <div>
          <label>Window End</label>
          <input type="time" id="bonusEnd" value="06:00">
        </div>
      </div>

      <div class="small" style="margin-top:8px;">
        Night-window bonus supports per-hour, per-shift, or per-week logic. Flat per shift pays once per worked shift.
      </div>

      <h2>Overtime Multipliers</h2>

      <label>Mon–Fri</label>
      <input type="number" step="0.01" id="otWeekday" placeholder="e.g. 1.25">

      <label>Saturday</label>
      <input type="number" step="0.01" id="otSaturday" placeholder="e.g. 1.25">

      <label>Sunday</label>
      <input type="number" step="0.01" id="otSunday" placeholder="e.g. 1.50">

      <label>Bank Holiday</label>
      <input type="number" step="0.01" id="otBankHoliday" placeholder="e.g. 2.00">

      <h2>Hours Rules</h2>

      <label>Base Weekly Hours</label>
      <input type="number" step="0.01" id="baseWeeklyHours" placeholder="e.g. 45">

      <label>Base Daily Paid Hours (Salaried)</label>
      <input type="number" step="0.01" id="baseDailyPaidHours" placeholder="e.g. 9">

      <label>Standard Shift Length (hrs) (optional)</label>
      <input type="number" step="0.01" id="standardShiftLength" placeholder="e.g. 10">

      <h2>Shift Entry Fields</h2>

      <div class="checkbox-row">
        <input type="checkbox" id="showVehicleField" checked>
        <span>Show vehicle field on Enter Shift</span>
      </div>

      <div class="checkbox-row">
        <input type="checkbox" id="showTrailerFields" checked>
        <span>Show trailer fields on Enter Shift</span>
      </div>

      <div class="checkbox-row">
        <input type="checkbox" id="showMileageFields">
        <span>Show mileage fields on Enter Shift</span>
      </div>

      <h2>Assigned Vehicles</h2>
      <div class="small" style="margin-top:-4px;">
        Only assigned vehicles appear in Enter Shift for this company.
      </div>
      <div id="companyVehicleIdsWrap" class="shift-card" style="margin-top:10px;"></div>

      <h2>Contact</h2>

      <label>Contact Name</label>
      <input type="text" id="contactName" placeholder="e.g. Transport Manager">

      <label>Contact Number</label>
      <input type="tel" id="contactNumber" placeholder="e.g. 07...">

      <button type="button" onclick="addOrUpdateCompany()">Save Company</button>
      <button type="button" class="button-secondary" onclick="resetCompanyForm()">Clear</button>
    </div>

    <h2 style="margin-top:18px;">Company List</h2>
    <div id="companyList"></div>
  </div>
</div>

<script src="app.js"></script>
<script>
  // Toggle form open/close
  const btn = document.getElementById("toggleCompanyFormBtn");
  const wrap = document.getElementById("companyFormWrap");
  btn.addEventListener("click", () => {
    wrap.style.display = (wrap.style.display === "none") ? "block" : "none";
  });

  // Show/hide daily OT fields based on payMode
  const payModeEl = document.getElementById("payMode");
  const dailyWrap = document.getElementById("dailyOtFields");

  function syncDailyFields(){
    dailyWrap.style.display = (payModeEl.value === "daily") ? "block" : "none";
  }

  payModeEl.addEventListener("change", syncDailyFields);
  syncDailyFields();
</script>
</body>
</html>
